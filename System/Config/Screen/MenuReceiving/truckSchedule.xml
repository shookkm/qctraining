<?xml version="1.0"?>
<!--DOCTYPE FLEXSCREEN SYSTEM "flexscreen.dtd" -->
<!--############################################################################
  #        File: orderCounts.xml
  # Description: Order Counts flex screen.
  #
  # COPYRIGHT (C) 2009 Queen City Software, Inc. All Rights Reserved.
  # No part of this copyrighted work may be reproduced, modified, or distributed
  # in any form or by any means without the prior written permission of
  # Queen City Software, Inc.
  #
  # $Id: truckSchedule.xml 9911 2018-03-15 14:20:24Z rlh $
  #
  # Notes:
  #
  ###########################################################################-->

<FLEXSCREEN title = "Truck Schedule" 
            height = "650" 
            width = "1100" 
            frametype = "internal"
            report = "false"
            updateSecurity = "truckSchedule.edit" 
            insertSecurity = "truckSchedule.edit"
            deleteSecurity = "truckSchedule.edit" >

  <!-- a dbConnect here is a universal connect object  -->
  <DBCONNECT type = "predefined" 
             connectionId = "default" 
             setglobal = "true"/>

  <INIT_ACTIONS>
    <INIT_ACTION type = "call" 
                 value = "CreateGlobalVariables" />
  </INIT_ACTIONS>
             
  <GLOBAL_DEFINITIONS>
    <VECTORMAP name = "truckScheduleStatuses"
               loadSql = "select idx,
                                 returnCodeMsg
                            from MnemonicCodesView
                            where mnemonicType = 'TRUCK_SCHEDULE_STATUSES'
                            order by idx" />
                            
    <VECTORMAP name = "truckScheduleStatusesByName"
               loadSql = "select '' returnCodeMsg, 0 idx
                          union
                          select returnCodeMsg, idx
                            from MnemonicCodesView
                            where mnemonicType = 'TRUCK_SCHEDULE_STATUSES'
                             order by idx" />
  </GLOBAL_DEFINITIONS>


  <SPLITPANE  divider = "110" orientation = "vertical">
    <FLEXSQLMODIFIERCOMPONENT  name = "skuStatsFilter"
                               orientation = "horizontal"
                               appendAsAnd = "false"
                               makeAbsolute = "false"
                               autoResize = "false"
                               autoExecute = "true"
                               maxFilterRows = "2"
                               editorWidth = "120"
                               showCheckBoxes = "false"
                               filterBorderText = "Filter Criteria"
                               filterBorderColor = "blue"
                               okButtonText = "Execute"
                               passiveMode = "false">

      <DBCONNECT type = "global"/>                    
                                        
        <FILTER_OPTION label = "Expected Date"
                       altValue = "expectedDate"
                       editorType = "calendar"
                       autoQuote = "true" >
          <CALENDAR_OPTIONS  pastEnabled = "true" 
                             deselectEnabled = "true"
                             monthsPast = "6" 
                             monthsFuture = "6"
                             format = "yyyy-MM-dd"/>

        </FILTER_OPTION>
  
      <FILTER_OPTION label = "Truck/Trailer"
                     altValue = "truck"
                     editorType = "text"
                     autoQuote = "true"/>
                          
      <FILTER_OPTION label = "ASN/PO" 
                     altValue = "asnPo" 
                     editorType = "text" 
                     autoQuote = "true" />
                          
      <FILTER_OPTION label = "Door#" 
                     altValue = "door" 
                     editorType = "text" 
                     autoQuote = "true" />
                     
  <FILTER_OPTION label = "Status"
                 altValue = "status"
                 editorType = "combo"
                 autoQuote = "true" >

    <COMBO_OPTIONS ifdef = "truckScheduleStatusesByName" />
  </FILTER_OPTION>
                               
    </FLEXSQLMODIFIERCOMPONENT>
    
    <SPLITPANE  divider = "250" 
                orientation = "vertical">
    
      <FLEXTABLECOMPONENT name = "SkuStatsTable" 
                          init = "init" 
                          refresh = "true" 
                          greenbar = "true"
                          sortable = "true"
                          ignoreEventConcatenation = "true">

        <DBCONNECT type = "global" />
        <TRIGGER name = "skuStatsFilter" />

        <TABLE key = "skuStatsFilter:execute" >
          <SELECT sql = "call TruckScheduleScreen(//expectedDate, 
                                                  //truck, 
                                                  //asnPo, 
                                                  //door, 
                                                  //status,
                                                  'status desc')"/>
                                                     
          <UPDATE sql = "call TruckScheuldeUpdateScreen(/*TruckId,
                                                        //DockDoor,
                                                        //DoorSchedule,
                                                        //Expected, 
                                                        null, 
                                                        //Received, 
                                                        '$QC_USER')"/>"                                        
          <TABLECOLUMNS>
            <TABLECOLUMN name = "TruckId"
                         maxWidth = "100"/>
                         
            <TABLECOLUMN name = "DockDoor"
                         maxWidth = "75"/>
                         
            <TABLECOLUMN name = "AsnPo"
                         preferredWidth = "200"/>
                         
            <TABLECOLUMN name = "Status"
                         maxWidth = "100"/>
                                                      
            <TABLECOLUMN name = "DoorSchedule"
                         preferredWidth = "160"/>
                         
            <TABLECOLUMN name = "Expected"
                         preferredWidth = "160"/>
                         
            <TABLECOLUMN name = "AtDoor"
                         preferredWidth = "160"/>
                         
            <TABLECOLUMN name = "Received"
                         preferredWidth = "160"/>
          </TABLECOLUMNS>
          
          <ALTVALUES>
            <FIELD name = "Status" 
                   ifdef = "truckScheduleStatuses" />
          </ALTVALUES>
        </TABLE>
      </FLEXTABLECOMPONENT>
      
      <FLEXTABLECOMPONENT name = "SkuStatsDetailTable" 
                          init = "init" 
                          refresh = "true" 
                          greenbar = "true"
                          sortable = "true"
                          ignoreEventConcatenation = "true">

        <DBCONNECT type = "global" />
        <TRIGGER name = "SkuStatsTable" />

        <TABLE key = "SkuStatsTable:skuStatsFilter:execute" >
          <SELECT sql = "call TruckScheduleExtrasScreen(//TruckId)" />
          <TABLECOLUMNS>
            <TABLECOLUMN name = "Description"
                         preferredWidth = "100"/>
                         
                                                      
            <TABLECOLUMN name = "TotalCaseCt"
                         maxWidth = "150"
                         align = "right"/>
                                                      
            <TABLECOLUMN name = "TotalQtyShipped"
                         maxWidth = "160"
                         align = "right"/>
                                                      
            <TABLECOLUMN name = "TotalPalletCt"
                         maxWidth = "150"
                         align = "right"/>
                                                      
            <TABLECOLUMN name = "GrossWeight"
                         maxWidth = "150"
                         align = "right"/>
                         
            <TABLECOLUMN name = "UpdateTs"
                         preferredWidth = "160"/>
          </TABLECOLUMNS>
        </TABLE>
      </FLEXTABLECOMPONENT>
    </SPLITPANE>
  </SPLITPANE>
</FLEXSCREEN>
