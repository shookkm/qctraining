<?xml version="1.0"?>
<!--
   - Filename:     productivityReport.xml
   - Description:
   -
   - (c) COPYRIGHT QC Software, LLC 2018 All Rights Reserved
   - No part of this copyrighted work may be reproduced, modified, or
   - distributed in any form or by any means without the prior written
   - permission of QC Software, LLC.
   -
   - $Id: productivityReport.xml 10242 2018-06-06 19:46:47Z wlw $
   - Notes:
  -->
<FLEXSCREEN title = "Pick Productivity Report" 
            height = "600" 
            width = "1100" 
            frametype = "internal"
            report = "false" >

  <!-- a dbConnect here is a universal connect object  -->
  <DBCONNECT type = "predefined" 
             connectionId = "default" 
             setglobal = "true"/>

  <GLOBAL_DEFINITIONS>
    <VECTOR name = "operators1"> 
       <ITEM value = " =" />
       <ITEM value = "like" />
    </VECTOR>

    <VECTOR name = "operators2"> 
       <ITEM value = " =" />
       <ITEM value = "&lt;" />
       <ITEM value = "&lt;=" />
       <ITEM value = "&lt;&gt;" />
       <ITEM value = "&gt;" />
       <ITEM value = "&gt;=" />
    </VECTOR>
    
    <VECTOR name = "operatorIn"> 
       <ITEM value = "in" />
       <ITEM value = "out" />
    </VECTOR>
    
    <VECTORMAP name = "orderBy" >
      <ITEM key = "Lines desc"      value = "Lines desc" />
      <ITEM key = "Lines"           value = "Lines" />
      <ITEM key = "Picks desc"      value = "Picks desc" />
      <ITEM key = "Picks"           value = "Picks" />
      <ITEM key = "Shorts desc"     value = "Shorts desc" />
      <ITEM key = "Shorts"          value = "Shorts" />
      <ITEM key = "Sku"             value = "sku" />
      <ITEM key = "Sku desc"        value = "sku desc" />
      <ITEM key = "OperatorId"      value = "OperatorId" />
      <ITEM key = "OperatorId desc" value = "OperatorId desc" />
      <ITEM key = "ZoneId"          value = "ZoneId" />
      <ITEM key = "ZoneId desc"     value = "ZoneId desc" />
    </VECTORMAP>
    
    <VECTORMAP name = "zones"
               loadSql = "select '' masterZoneId, '' value
                          union
                          select distinct zoneId, coalesce(description, zoneId) value
                            from LocationZones
                            where flags &amp; gLocationZoneForwardPickFlag = gLocationZoneForwardPickFlag
                            order by masterZoneId" />
     
  </GLOBAL_DEFINITIONS>

  <REPORTS>
    <DBCONNECT type = "global" />
  </REPORTS>

  <TABPANE>
    <TAB title = "Pickers By Month">
      <SPLITPANE  divider = "110" orientation = "vertical">
        <FLEXSQLMODIFIERCOMPONENT  name = "PickerProdMonthSqlFilter"
                                   orientation = "horizontal"
                                   appendAsAnd = "false"
                                   makeAbsolute = "false"
                                   autoResize = "false"
                                   autoExecute = "true"
                                   maxFilterRows = "3"
                                   editorWidth = "120"
                                   showCheckBoxes = "false"
                                   filterBorderText = "Filter Criteria"
                                   filterBorderColor = "blue"
                                   okButtonText = "Refresh"
                                   passiveMode = "true" >

         <FILTER_OPTION label = "From Month"
                         altValue = "fromMonth"
                         editorType = "calendar"
                         autoQuote = "true" >
            <CALENDAR_OPTIONS  pastEnabled = "true" deselectEnabled = "true"
                               monthsPast = "6" monthsFuture = "0"
                               format = "yyyy-MM"/>

          </FILTER_OPTION>

          <FILTER_OPTION label = "SKU" 
                         altValue = "unit" 
                         editorType = "text" 
                         autoQuote = "true" />

          <FILTER_OPTION label = "OperatorId" 
                         altValue = "operatorId" 
                         editorType = "text" 
                         autoQuote = "true" />
                         
         <FILTER_OPTION label = "To Month"
                         altValue = "toMonth"
                         editorType = "calendar"
                         autoQuote = "true" >
            <CALENDAR_OPTIONS  pastEnabled = "true" deselectEnabled = "true"
                               monthsPast = "6" monthsFuture = "0"
                               format = "yyyy-MM"/>

          </FILTER_OPTION>

          <FILTER_OPTION label = "MasterZoneId"
                         altValue = "masterZoneId"
                         editorType = "combo"
                         autoQuote = "true">
            <COMBO_OPTIONS ifdef = "zones"/>
          </FILTER_OPTION>
           
          <FILTER_OPTION label = "Picks (&gt;,&lt;,=)" 
                         altValue = "picksGtr" 
                         editorType = "text" 
                         autoQuote = "true" />

          <FILTER_OPTION label = "Lines (&gt;,&lt;,=)" 
                         altValue = "linesGtr" 
                         editorType = "text" 
                         autoQuote = "true" />
                         
        </FLEXSQLMODIFIERCOMPONENT>

        <SPLITPANE  divider = "110" orientation = "vertical">
          <FLEXTABLECOMPONENT name = "PickerCountsMonthTable" 
                              init = "init" 
                              refresh = "true" 
                              greenbar = "true"
                              sortable = "true"
                              records = "1000" 
                              ignoreEventConcatenation = "false">

            <DBCONNECT type = "global" />
            <TRIGGER name = "PickerProdMonthSqlFilter" />
   
            <TABLE key = "PickerProdMonthSqlFilter:execute" >

                <SELECT sql = "call PickProdReport(//fromMonth, 
                                                   //toMonth, 
                                                   null, 
                                                   //unit, 
                                                   //masterZoneId, 
                                                   //operatorId,
                                                   '', 
                                                   //picksGtr,
                                                   //linesGtr,
                                                   'month')" />  

              <TABLECOLUMNS>
                <TABLECOLUMN name = "Month"
                             maxWidth = "70"/>
                             
                <TABLECOLUMN name = "OperatorId"
                             preferredWidth = "100"/>
                             
                <TABLECOLUMN name = "ZoneId"
                             maxWidth = "70"/>
                             
                <TABLECOLUMN name = "Sku"
                             preferredWidth = "30"/>
                             
                <TABLECOLUMN name = "LocationCt"
                             preferredWidth = "80"/>
                             
                <TABLECOLUMN name = "Lines"
                             maxWidth = "80"
                             align = "right"/>
                             
                <TABLECOLUMN name = "LocationCt" 
                             maxWidth = "80"
                             align = "right" />
                             
                <TABLECOLUMN name = "Lines/Day" 
                             maxWidth = "80"
                             align = "right" />
                             
                <TABLECOLUMN name = "Picks" 
                             maxWidth = "80"
                             align = "right" />
                             
                <TABLECOLUMN name = "Picks/Day" 
                             maxWidth = "80"
                             align = "right" />
                             
                <TABLECOLUMN name = "Shorts" 
                             maxWidth = "80"
                             align = "right" />
                             
                <TABLECOLUMN name = "Shorts/Hour" 
                             maxWidth = "80"
                             align = "right" />
              </TABLECOLUMNS>

            </TABLE>
          </FLEXTABLECOMPONENT>

          <FLEXTABLECOMPONENT name = "PickerDetailCountsDayTable" 
                              init = "init" 
                              refresh = "true" 
                              greenbar = "true"
                              sortable = "true"
                              records = "1000" 
                              ignoreEventConcatenation = "false">

            <DBCONNECT type = "global" />
            <TRIGGER name = "PickerCountsMonthTable" />
   
            <TABLE key = "PickerCountsMonthTable:PickerProdMonthSqlFilter:execute" >
    
              <SELECT sql = "call PickProdReport(//Month, 
                                                  null, 
                                                  null, 
                                                  //Sku, 
                                                  //MasterZoneId, 
                                                  //OperatorId,
                                                  null, 
                                                  //picksGtr,
                                                  //linesGtr,
                                                 'monthByDay')"  />
                                                 

              <TABLECOLUMNS>
                <TABLECOLUMN name = "Day"
                             preferredWidth = "120"
                             maxWidth = "120"/>
                             
                <TABLECOLUMN name = "ZoneId"
                             preferredWidth = "100"/>
                             
                <TABLECOLUMN name = "Sku"
                             maxWidth = "100"/>
                                                                                            
                <TABLECOLUMN name = "LocationCt"
                             maxWidth = "70"/>
                             
                <TABLECOLUMN name = "Lines"
                             maxWidth = "80"
                             align = "right"/>                                 
                             
                <TABLECOLUMN name = "Lines/Hour" 
                             maxWidth = "80"
                             align = "right" />
                              
                <TABLECOLUMN name = "Picks"
                             maxWidth = "80"
                             align = "right"/>
                            
                <TABLECOLUMN name = "Picks/Hour" 
                             maxWidth = "80"
                             align = "right" />
                             
               <TABLECOLUMN name = "Shorts"
                             maxWidth = "80"
                             align = "right"/>
                             
                <TABLECOLUMN name = "Shorts/Day" 
                             maxWidth = "80"
                             align = "right" />
              </TABLECOLUMNS>
            </TABLE>
          </FLEXTABLECOMPONENT>
        </SPLITPANE>
      </SPLITPANE>
    </TAB>
    
    <TAB title = "Pickers By Day">
      <SPLITPANE  divider = "110" orientation = "vertical">
        <FLEXSQLMODIFIERCOMPONENT  name = "PickerProdDaySqlFilter"
                                   orientation = "horizontal"
                                   appendAsAnd = "false"
                                   makeAbsolute = "false"
                                   autoResize = "false"
                                   autoExecute = "true"
                                   maxFilterRows = "3"
                                   editorWidth = "120"
                                   showCheckBoxes = "false"
                                   filterBorderText = "Filter Criteria"
                                   filterBorderColor = "blue"
                                   okButtonText = "Refresh"
                                   passiveMode = "true" >

         <FILTER_OPTION label = "From Date"
                         altValue = "fromDate"
                         editorType = "calendar"
                         autoQuote = "true" >
            <CALENDAR_OPTIONS  pastEnabled = "true" deselectEnabled = "true"
                               monthsPast = "6" monthsFuture = "0"
                               format = "yyyy-MM-dd"/>

          </FILTER_OPTION>

          <FILTER_OPTION label = "SKU" 
                         altValue = "unit" 
                         editorType = "text" 
                         autoQuote = "true" />

          <FILTER_OPTION label = "OperatorId" 
                         altValue = "operatorId" 
                         editorType = "text" 
                         autoQuote = "true" />
                         
          <FILTER_OPTION label = "To Date"
                         altValue = "toDate"
                         editorType = "calendar"
                         autoQuote = "true" >
            <CALENDAR_OPTIONS  pastEnabled = "true" deselectEnabled = "true"
                               monthsPast = "6" monthsFuture = "0"
                               format = "yyyy-MM-dd"/>

          </FILTER_OPTION>

          <FILTER_OPTION label = "MasterZoneId"
                         altValue = "masterZoneId"
                         editorType = "combo"
                         autoQuote = "true">
            <COMBO_OPTIONS ifdef = "zones"/>
          </FILTER_OPTION>
                                       
          <FILTER_OPTION label = "Picks (&gt;,&lt;,=)" 
                         altValue = "picksGtr" 
                         editorType = "text" 
                         autoQuote = "true" />

          <FILTER_OPTION label = "Lines (&gt;,&lt;,=)" 
                         altValue = "linesGtr" 
                         editorType = "text" 
                         autoQuote = "true" />
                         
        </FLEXSQLMODIFIERCOMPONENT>

        <SPLITPANE  divider = "110" orientation = "vertical">
          <FLEXTABLECOMPONENT name = "PickerCountsDayTable" 
                              init = "init" 
                              refresh = "true" 
                              greenbar = "true"
                              sortable = "true"
                              records = "1000" 
                              ignoreEventConcatenation = "false">

            <DBCONNECT type = "global" />
            <TRIGGER name = "PickerProdDaySqlFilter" />
   
            <TABLE key = "PickerProdDaySqlFilter:execute" >
 
               <SELECT sql = "call PickProdReport(//fromDate, 
                                                  //toDate, 
                                                  null, 
                                                  //unit, 
                                                  //masterZoneId, 
                                                  //operatorId,
                                                  'day desc', 
                                                  //picksGtr,
                                                  //linesGtr,
                                                 'day')" />
              <TABLECOLUMNS>
                <TABLECOLUMN name = "Day"
                             preferredWidth = "120"
                             maxWidth = "120"/>
                             
                <TABLECOLUMN name = "OperatorId"
                             preferredWidth = "100"/>
                             
                <TABLECOLUMN name = "Sku"
                             maxWidth = "100"/>
                             
                <TABLECOLUMN name = "ZoneId"
                             maxWidth = "70"/>
                             
                <TABLECOLUMN name = "Lines"
                             maxWidth = "80"
                             align = "right"/>
                             
                <TABLECOLUMN name = "Picks"
                             maxWidth = "80"
                             align = "right"/>
                             
                <TABLECOLUMN name = "Shorts"
                             maxWidth = "80"
                             align = "right"/>
                             
                <TABLECOLUMN name = "LocationCt" 
                             maxWidth = "80"
                             align = "right" />
                             
                <TABLECOLUMN name = "Lines/Hour" 
                             maxWidth = "80"
                             align = "right" />
                             
                <TABLECOLUMN name = "Picks/Hour" 
                             maxWidth = "80"
                             align = "right" />
                             
                <TABLECOLUMN name = "Shorts/Hour" 
                             maxWidth = "80"
                             align = "right" />
              </TABLECOLUMNS>

            </TABLE>
          </FLEXTABLECOMPONENT>

          <TABPANE>
            <TAB title = "Hourly Details">
              <FLEXTABLECOMPONENT name = "PickerDetailCountsDayTable" 
                                  init = "init" 
                                  refresh = "true" 
                                  greenbar = "true"
                                  sortable = "true"
                                  records = "1000" 
                                  ignoreEventConcatenation = "false">

                <DBCONNECT type = "global" />
                <TRIGGER name = "PickerCountsDayTable" />
       
                <TABLE key = "PickerCountsDayTable:PickerProdDaySqlFilter:execute" >
                  <SELECT sql = "call PickProdReport(//Day, 
                                                     null, 
                                                     null, 
                                                     //Sku, 
                                                     //MasterZoneId, 
                                                     //OperatorId,
                                                     null, 
                                                     //picksGtr,
                                                     //linesGtr,
                                                     'dayByHour')" />

                  <TABLECOLUMNS>
                    <TABLECOLUMN name = "Day"
                                 preferredWidth = "120"
                                 maxWidth = "120"/>
                                 
                    <TABLECOLUMN name = "ZoneId"
                                 preferredWidth = "100"/>
                                 
                    <TABLECOLUMN name = "Sku"
                                 maxWidth = "100"/>
                                                                                                
                    <TABLECOLUMN name = "LocationCt"
                                 maxWidth = "70"/>
                                 
                    <TABLECOLUMN name = "Lines"
                                 maxWidth = "80"
                                 align = "right"/>                                 
                                 
                    <TABLECOLUMN name = "Lines/Hour" 
                                 maxWidth = "80"
                                 align = "right" />
                                  
                    <TABLECOLUMN name = "Picks"
                                 maxWidth = "80"
                                 align = "right"/>
                                
                    <TABLECOLUMN name = "Picks/Hour" 
                                 maxWidth = "80"
                                 align = "right" />
                                 
                   <TABLECOLUMN name = "Shorts"
                                 maxWidth = "80"
                                 align = "right"/>
                                 
                    <TABLECOLUMN name = "Shorts/Hour" 
                                 maxWidth = "80"
                                 align = "right" />
                  </TABLECOLUMNS>
                </TABLE>
              </FLEXTABLECOMPONENT>
            </TAB>

          </TABPANE>
        </SPLITPANE>
      </SPLITPANE>
    </TAB>
  </TABPANE>
</FLEXSCREEN>
