<?xml version="1.0"?>
<!--
   - Filename:     plcInterface.xml
   - Description:
   -
   - (c) COPYRIGHT QC Software, LLC 2017 All Rights Reserved
   - No part of this copyrighted work may be reproduced, modified, or
   - distributed in any form or by any means without the prior written
   - permission of QC Software, LLC.
   -
   - $Id: plcInterface.xml 9566 2017-09-06 17:08:37Z wlw $
   - Notes:
  -->
<!--
     Attributes:
       defaultTimeout - the timeout in milliseconds to wait for a response from
                        a PLC when a read or write command is sent.
                        The default is 1000.
       msgThrottle - delay in microseconds before sending messages to a PLC.
                     This affects every message sent to a PLC.
                     The default is 0.
       commandTerminator - terminate value for command messages.  If the value
                           begins with "0x", it is interpreted as a hexadecimal
                           value; otherwise, it is assumed it is a decimal
                           value.  The default is 0xa0d.
       defaultDataType - default data type for the old PLC read/write requests
                         when the data type cannot be determined based on the
                         address.  The options are WORD or LONGWORD.  This is
                         an issue when using tag names that do not match PCCC
                         addressing format.  The default is WORD.
       port - port to listen on for PLC connections.  The default is 44818.
       connectTimerValue - controls the timer used when connecting to a PLC.
                           The default is 10 seconds.
  -->
<EthIpInterface>
  <!--
       The QcInit element should be defined if we have a database connection
       so the message number can be initialized based on the transaction log.
    -->
  <QcInit dbId = "wcs"/>

  <!--
       Define the database connections to be used.  Environmental variables
       can be used in the values which will then be looked up.

       Database connections are optional.
    -->
  <DbConnect id = "wcs"
             machine = "$DATABASE_MACHINE"
             database = "$DATABASE_NAME"
             port = "$DATABASE_PORT"
             user = "plcInterface"
             password = "plcInterface"
             adapter = "Library.Database.IAnywhereDatabaseAdapter"
             trackStatements = "true"/>

  <!--
       Define the default database pool because the PLC
       communications use it to access the database.
    -->
  <DbPool dbId = "wcs" minSize = "1"/>

  <!--
       Defines the PLC's that are to be connected to.

       Attributes:
         number - PLC number.
         address - IP address of PLC.
         type - type of PLC derived from Packages.RTA.RtaPlc.Type.
         slot - chassis slot processor is in.  Default is 0.
    -->
  <Plc number = "1" address = "192.168.1.200" type = "SLC"/>

  <!--
       Defines the memory address within the interface which a PLC can read
       from and write to.  At the moment, a PLC must use a PLC5 typed
       read/write to access this memory; therefore, the address must be in
       PCCC address format.

       Attributes and elements:
         address - address name to be used for access.
         elements - number of elements for memory allocation.
         type - data type for memory derived from
                Packages.RTA.RtaPlcAddress.Type.  If not set, the address is
                assumed to be in PCCC address format from which the data type
                can be derived.
         Forward - sub-element defining applications to receive a write
                   notice.
           command - command that was received if the command is to be taken
                     into consideration.  Default is the command is not used.
           appName - name of application to receive notice or '?' to lookup
                     the id in the AppMap.
           critical - true if the message should be logged for later transmit
                      if the application is not connected.  This requires the
                      default data pool be defined since the transaction log is
                      used for this.  The default is false.
    -->
  <Memory address = "N102" elements = "80" type = "WORD">
    <Forward appName = "?"/>
  </Memory>

  <!--
       Defines the mapping of applications to id numbers in the messages.

       Attributes:
         appName - name of application.
         id - id number for application.
    -->
  <AppMap appName = "scannerMgr" id = "100"/>
  <AppMap appName = "toteMgr" id = "101"/>

  <!--
       The existance of this element indicates the standard command indexing
       is to be used.  It also defines the various indexes to be used.  Setting
       any index to -1 disables that index.

       Attributes -
         lengthIdx - index of length word.  Default is 0.
         commandIdx - index of command word.  Default is 1.
         msgNoIdx - index of message number word.  Default is 2.
         requestMsgNoIdx - index of requesting message number word.
                           Default is 3.
         statusIdx - index of status word.  Default is 4.
         sourceIdx - index of source id word.  Default is 5.
         destinationIdx - index of destination id word.  Default is 6.
    -->
  <CommandIndexes lengthIdx = "0"
                  commandIdx = "1"
                  msgNoIdx = "2"
                  requestMsgNoIdx = "3"
                  statusIdx = "4"
                  sourceIdx = "5"
                  destinationIdx = "6"/>

  <DataDefinition name = "Scan Notification" command = "200" direction = "IN">
    <Word idx = "0" name = "length          "/>
    <Word idx = "1" name = "command         "/>
    <Word idx = "2" name = "msg no          "/>
    <Word idx = "5" name = "msg source      "/>
    <Word idx = "6" name = "msg dest        "/>
    <Word idx = "7" name = "scanner id      "/>
    <Word idx = "8" name = "seq no          "/>
    <Word idx = "11" name = "barcode length  "/>
    <Word idx = "12" name = "barcode word[0] "/>
    <Word idx = "13" name = "barcode word[1] "/>
    <Word idx = "14" name = "barcode word[2] "/>
    <Word idx = "15" name = "barcode word[3] "/>
    <Word idx = "16" name = "barcode word[4] "/>
    <Word idx = "17" name = "barcode word[5] "/>
    <Word idx = "18" name = "barcode word[6] "/>
    <Word idx = "19" name = "barcode word[7] "/>
    <Word idx = "20" name = "barcode word[8] "/>
    <Word idx = "21" name = "barcode word[9] "/>
    <Word idx = "22" name = "barcode word[10]"/>
    <Word idx = "23" name = "barcode word[11]"/>
    <Word idx = "24" name = "barcode word[12]"/>
    <Word idx = "25" name = "barcode word[13]"/>
    <Word idx = "26" name = "barcode word[14]"/>
    <Word idx = "27" name = "barcode word[15]"/>
    <Word idx = "28" name = "barcode word[16]"/>
    <Word idx = "29" name = "barcode word[17]"/>
    <Word idx = "30" name = "barcode word[18]"/>
    <Word idx = "31" name = "barcode word[19]"/>
    <Word idx = "32" name = "barcode word[20]"/>
    <Word idx = "33" name = "barcode word[21]"/>
    <Word idx = "34" name = "barcode word[22]"/>
    <Word idx = "35" name = "barcode word[23]"/>
    <Word idx = "36" name = "barcode word[24]"/>
    <Word idx = "37" name = "barcode word[25]"/>
    <Word idx = "38" name = "barcode word[26]"/>
    <Word idx = "39" name = "terminator      "/>
  </DataDefinition>

  <DataDefinition name = "Routing Request" command = "201" direction = "OUT">
    <Word idx = "0" name = "length        "/>
    <Word idx = "1" name = "command       "/>
    <Word idx = "2" name = "msg no        "/>
    <Word idx = "5" name = "msg source    "/>
    <Word idx = "6" name = "msg dest      "/>
    <Word idx = "7" name = "scanner id    "/>
    <Word idx = "8" name = "seq no        "/>
    <Word idx = "9" name = "primary dest  "/>
    <Word idx = "10" name = "secondary dest"/>
    <Word idx = "19" name = "terminator    "/>
  </DataDefinition>

  <DataDefinition name = "Routing Response" command = "201" direction = "IN">
    <Word idx = "0" name = "length     "/>
    <Word idx = "1" name = "command    "/>
    <Word idx = "2" name = "msg no     "/>
    <Word idx = "4" name = "status     "/>
    <Word idx = "5" name = "msg source "/>
    <Word idx = "6" name = "msg dest   "/>
    <Word idx = "7" name = "scanner id "/>
    <Word idx = "8" name = "seq no     "/>
    <Word idx = "9" name = "actual lane"/>
    <Word idx = "19" name = "terminator "/>
  </DataDefinition>
</EthIpInterface>
